<app-modal #dialog [config]="{width: '600px', disableClose: true}">
  <h2 mat-dialog-title>Ajouter un adhérent</h2>
  <mat-dialog-content fxLayout="column">
    <form [formGroup]="formGroup" fxLayout="column" class="form-field-block">
      <dynamic-material-form [group]="formGroup" [model]="model" (change)="onNewMemberChange($event)">
      </dynamic-material-form>
    </form>
    <div *ngIf="newMember.firstName && newMember.school">
      <h4 class="mat-title">Options</h4>
      <mat-selection-list #optionsList [(ngModel)]="optionSelected" (selectionChange)="onOptionChange($event)">
        <div *ngIf="sameMembers.length > 0">
          <h5 class="mat-subheading-1">Ré-inscrire un adhérent parmi les anciens adhérents similaires trouvés:</h5>
          <mat-list-option *ngFor="let sameMember of sameMembers" [value]="sameMember">
            {{sameMember.lastName + ' | ' + sameMember.firstName + ' | ' + sameMember.school + ' | Ancien adhérent ' + sameMember.registrations[sameMember.registrations.length - 1].year }}
          </mat-list-option>
        </div>
        <h5 class="mat-subheading-1">Créer une nouvelle fiche adhérent:</h5>
        <mat-list-option selected [value]="null">
          {{newMember.lastName + ' | ' + newMember.firstName + ' | ' + newMember.school + ' | Nouvel adhérent' }}
        </mat-list-option>
      </mat-selection-list>
    </div>
  </mat-dialog-content>
  <mat-dialog-actions>
    <span fxFlex></span>
    <button mat-button (click)="dialog.close()">Annuler</button>
    <button mat-button *ngIf="!selectedOption" [disabled]="!formGroup.valid && !formGroup.dirty"
      (click)="dialog.close('create')">
      Créer
    </button>
    <button mat-button *ngIf="selectedOption" [disabled]="!formGroup.valid && !formGroup.dirty"
      (click)="dialog.close('register')">
      Ré-inscrire
    </button>
  </mat-dialog-actions>
</app-modal>
