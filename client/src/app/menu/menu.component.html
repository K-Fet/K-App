<div class="body-container" [class.is-mobile]="mobileQuery.matches">
	<mat-toolbar color="primary" class="toolbar">
		<button mat-icon-button (click)="snav.toggle()" *ngIf="isGuest()"><mat-icon>menu</mat-icon></button>
		<h1 class="app-name">K-App</h1>
		<span class="spacer"></span>
        <mat-menu #personnalInformation="matMenu" [overlapTrigger]="false">
            <div *ngIf="user?.barman">
				<p>Compte Barman {{user.barman.nickname}}</p>
				<!-- TODO add more information -->
			</div>
			<div *ngIf="user?.specialAccount">
				<p>Compte spécial {{user.specialAccount.connection.username}}</p>
				<!-- TODO add more information -->
			</div>
        </mat-menu>
        <button *ngIf="isGuest()" mat-icon-button [matMenuTriggerFor]="personnalInformation">
            <mat-icon class="example-icon">person</mat-icon>
        </button>
		<button type="button" mat-icon-button (click)="logout()" *ngIf="isGuest()">
			<mat-icon>power_settings_new</mat-icon>
		</button>
	</mat-toolbar>
	<mat-sidenav-container class="sidenav-container" [style.marginTop.px]="mobileQuery.matches ? 56 : 0">
		<mat-sidenav #snav [mode]="mobileQuery.matches ? 'over' : 'side'"
		[fixedInViewport]="mobileQuery.matches" fixedTopGap="56" class="sidenav">
		<mat-nav-list>
			<mat-list>
				<span *ngIf="user?.barman">
					<a mat-list-item  routerLink="/dashboard">Dashboard</a>
				</span>

				<div *ngIf="user?.specialAccount">
					<mat-divider *ngxPermissionsOnly="['member:read','member:write']"></mat-divider>
					<h3 mat-subheader *ngxPermissionsOnly="['member:read','member:write']">Adhérents</h3>
					<a mat-list-item routerLink="/members" *ngxPermissionsOnly="'member:read'">Liste</a>
					<a mat-list-item routerLink="/members/new" *ngxPermissionsOnly="'member:write'">Nouveau</a>

					<mat-divider *ngxPermissionsOnly="['barman:read','barman:write']"></mat-divider>
					<h3 mat-subheader *ngxPermissionsOnly="['barman:read','barman:write']">Barmen</h3>
					<a mat-list-item routerLink="/barmen" *ngxPermissionsOnly="'barman:read'">Liste</a>
					<a mat-list-item routerLink="/barmen/new" *ngxPermissionsOnly="'barman:write'">Nouveau</a>

					<mat-divider *ngxPermissionsOnly="['kommission:read','kommission:write']"></mat-divider>
					<h3 mat-subheader *ngxPermissionsOnly="['kommission:read','kommission:write']">Kommissions</h3>
					<a mat-list-item routerLink="/kommissions" *ngxPermissionsOnly="'kommission:read'">Liste</a>
					<a mat-list-item routerLink="/kommissions/new" *ngxPermissionsOnly="'kommission:write'">Nouveau</a>

					<mat-divider *ngxPermissionsOnly="['role:read','role:write']"></mat-divider>
					<h3 mat-subheader *ngxPermissionsOnly="['role:read','role:write']">Rôles</h3>
					<a mat-list-item routerLink="/roles" *ngxPermissionsOnly="'role:read'">Liste</a>
					<a mat-list-item routerLink="/roles/new" *ngxPermissionsOnly="'role:write'">Nouveau</a>

					<mat-divider *ngxPermissionsOnly="['service:write']"></mat-divider>
        			<a mat-list-item *ngxPermissionsOnly="['service:write']" routerLink="/open-services">Ouvrir les service</a>
				</div>
			</mat-list>
		</mat-nav-list>
		</mat-sidenav>
		<mat-sidenav-content class="components-container">
		<router-outlet></router-outlet>
		</mat-sidenav-content>
	</mat-sidenav-container>
</div>
